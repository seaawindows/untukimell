<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Untuk Imelda ‚ù§Ô∏è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;500;600&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ff4081;
            --secondary-color: #ff79b0;
            --accent-color: #ff9ec5;
            --dark-bg: #0f172a;
            --paper-color: #fef9e7;
            --text-color: #333;
            --light-bg: #fff5f8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            font-size: 16px;
            line-height: 1.6;
        }

        /* Optimasi untuk Android */
        html {
            -webkit-text-size-adjust: 100%;
            -webkit-font-smoothing: antialiased;
        }

        /* Background bintang */
        .star-field {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Container utama */
        .mobile-container {
            width: 100%;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Halaman dengan scroll vertikal */
        .page-scroll {
            width: 100%;
            min-height: 100vh;
            padding: 20px 15px 80px;
            display: none;
            flex-direction: column;
            align-items: center;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.5s ease;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .page-scroll.active {
            display: flex;
            opacity: 1;
            position: relative;
        }

        /* Header setiap halaman */
        .page-header {
            text-align: center;
            margin-bottom: 25px;
            width: 100%;
        }

        .page-title {
            font-family: 'Dancing Script', cursive;
            font-size: 2.2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(255, 64, 129, 0.3);
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Bingkai foto */
        .photo-frame {
            width: 85%;
            max-width: 300px;
            margin: 20px auto;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(255, 64, 129, 0.3);
            position: relative;
        }

        .photo-frame::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            border-radius: 25px;
            z-index: -1;
            opacity: 0.5;
        }

        .photo-container {
            width: 100%;
            height: 350px;
            background: linear-gradient(45deg, #ffccd5, #ffb8e2);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--primary-color);
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            text-align: center;
            padding: 20px;
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .photo-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Halaman 4: Scrapbook (PERBAIKAN UTAMA) */
        .scrapbook-page-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        .scrapbook-page-single {
            background: var(--paper-color);
            border-radius: 15px;
            padding: 25px 20px;
            margin-bottom: 25px;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.1),
                0 0 0 10px #f5e6d3,
                0 0 0 13px #e8d0b3;
            position: relative;
            min-height: 400px;
            border: 1px solid #d4b896;
            transform-style: preserve-3d;
            transform: perspective(1000px) rotateY(-1deg);
            opacity: 0;
            animation: fadeIn 0.8s ease forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .scrapbook-page-single:nth-child(even) {
            transform: perspective(1000px) rotateY(1deg);
        }

        /* Garis kertas - FIXED */
        .paper-lines {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            background-image: 
                repeating-linear-gradient(
                    transparent,
                    transparent 23px,
                    rgba(139, 115, 85, 0.1) 23px,
                    rgba(139, 115, 85, 0.1) 24px
                ),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 95%,
                    rgba(139, 115, 85, 0.1) 95%,
                    rgba(139, 115, 85, 0.1) 100%
                );
            background-size: 100% 24px, 100% 100%;
            pointer-events: none;
            z-index: 1;
        }

        .scrapbook-content {
            position: relative;
            z-index: 2;
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            line-height: 1.8;
            color: #5a3d2b;
            min-height: 300px;
        }

        .scrapbook-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(255, 64, 129, 0.3);
            text-align: center;
        }

        /* Typewriter effect - FIXED */
        .typewriter-container {
            min-height: 200px;
            position: relative;
        }

        .typewriter-text {
            display: inline;
            white-space: pre-wrap;
            overflow: hidden;
        }

        .typewriter-cursor {
            display: inline-block;
            width: 2px;
            height: 1.4em;
            background-color: var(--primary-color);
            margin-left: 2px;
            animation: blink 0.8s infinite;
            vertical-align: middle;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .scrapbook-decoration {
            position: absolute;
            font-size: 1.8rem;
            opacity: 0.6;
            z-index: 3;
        }

        .page-number {
            position: absolute;
            bottom: 15px;
            right: 20px;
            font-family: 'Playfair Display', serif;
            font-style: italic;
            color: #8b7355;
            font-size: 0.9rem;
        }

        /* Scrapbook navigation - IMPROVED */
        .scrapbook-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            padding: 15px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 2px solid var(--primary-color);
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
        }

        .scrapbook-nav-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 64, 129, 0.3);
            transition: all 0.3s;
        }

        .scrapbook-nav-btn:active {
            transform: scale(0.95);
        }

        .scrapbook-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .scrapbook-page-indicator {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid var(--primary-color);
        }

        /* Navigation dots */
        .nav-dots {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 12px 20px;
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid var(--primary-color);
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-dot.active {
            background: var(--primary-color);
            transform: scale(1.3);
            box-shadow: 0 0 10px var(--primary-color);
        }

        /* Mobile controls */
        .mobile-controls {
            position: fixed;
            top: 15px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 15px;
            z-index: 1000;
        }

        .music-control {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid var(--primary-color);
            cursor: pointer;
        }

        .page-indicator {
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .page-title {
                font-size: 1.8rem;
            }
            
            .photo-container {
                height: 300px;
            }
            
            .scrapbook-page-single {
                padding: 20px 15px;
                min-height: 350px;
            }
            
            .scrapbook-content {
                font-size: 1.2rem;
            }
            
            .scrapbook-nav-btn {
                padding: 10px 20px;
                font-size: 0.8rem;
            }
        }

        @media (max-height: 600px) {
            .scrapbook-page-single {
                min-height: 300px;
            }
            
            .scrapbook-content {
                min-height: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- Background bintang -->
    <div class="star-field" id="starField"></div>

    <!-- Kontrol mobile -->
    <div class="mobile-controls">
        <div class="page-indicator" id="pageIndicator">Halaman 1/7</div>
        <div class="music-control" id="musicControl">
            <i class="fas fa-play"></i>
        </div>
    </div>

    <!-- Audio player -->
    <audio id="bgMusic" loop>
        <source src="blue yung kai.mp3" type="audio/mpeg">
    </audio>

    <!-- Halaman 1: Foto utama -->
    <div class="page-scroll active" id="page1">
        <div class="page-header">
            <h1 class="page-title">Untuk Imelda ‚ù§Ô∏è</h1>
        </div>
        
        <div class="photo-container">
        <img id="imeldaPhoto" src="imel14.png" alt="Foto Imelda" style="width:100%; height:100%; object-fit:cover; border-radius:15px;">
    </div>
        
        <div style="color: white; text-align: center; margin-top: 20px; font-size: 1.2rem; font-family: 'Dancing Script', cursive;">
            hii imeell cantiikkk lucuuukk gemessssin>.<
        </div>
    </div>

    <!-- Halaman 2: Ucapan terima kasih -->
    <div class="page-scroll" id="page2">
        <div class="page-header">
            <h1 class="page-title">Terima Kasih ‚ù§Ô∏è</h1>
        </div>
        
        <div style="background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 25px; margin: 20px auto; width: 90%; max-width: 500px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);">
            <p style="margin-bottom: 15px; font-size: 1rem; line-height: 1.7;">Hai Imel, terima kasih banyak sudah menemani aku selama ini. Setiap hari bersamamu adalah hari yang penuh warna dan tawa.</p>
            <p style="margin-bottom: 15px; font-size: 1rem; line-height: 1.7;">Kamu tahu nggak sih, kalau senyumanmu itu bisa bikin hari-hari sulit jadi lebih ringan?</p>
            <p style="margin-top: 20px; font-weight: 600; color: var(--primary-color); text-align: center; font-family: 'Dancing Script', cursive; font-size: 1.3rem;">
                Aku sayang banget sama kamu, Imel! ‚ù§Ô∏è
            </p>
        </div>
    </div>

    <!-- Halaman 3: Kembang api -->
    <div class="page-scroll" id="page3">
        <div class="page-header">
            <h1 class="page-title">Selamat Tahun Baru! üéÜ</h1>
        </div>
        
        <div style="text-align: center; margin: 30px auto; max-width: 400px;">
            <button id="startFireworks" style="background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: white; border: none; padding: 15px 30px; border-radius: 50px; font-size: 1rem; font-weight: 600; cursor: pointer; box-shadow: 0 8px 20px rgba(255,64,129,0.3);">
                <i class="fas fa-play"></i> Tampilkan Kembang Api
            </button>
        </div>
        
        <div id="fireworksContainer" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;"></div>
    </div>

    <!-- Halaman 4: Scrapbook (PERBAIKAN UTAMA) -->
    <div class="page-scroll" id="page4">
        <div class="page-header">
            <h1 class="page-title">Scrapbook Kenangan üìñ</h1>
        </div>
        
        <div class="scrapbook-page-container" id="scrapbookContainer">
            <!-- Halaman scrapbook akan dimuat dengan JavaScript -->
        </div>
    </div>

    <!-- Navigasi scrapbook -->
    <div class="scrapbook-nav" id="scrapbookNav">
        <button class="scrapbook-nav-btn" id="prevScrapbookPage">
            <i class="fas fa-arrow-left"></i> Sebelumnya
        </button>
        
        <div class="scrapbook-page-indicator">
            <span id="currentScrapbookPage">1</span>/<span id="totalScrapbookPages">7</span>
        </div>
        
        <button class="scrapbook-nav-btn" id="nextScrapbookPage">
            Selanjutnya <i class="fas fa-arrow-right"></i>
        </button>
    </div>

    <!-- Halaman 5: Love animation -->
    <div class="page-scroll" id="page5">
        <div class="page-header">
            <h1 class="page-title">Untuk Kamu üíñ</h1>
        </div>
        
        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 60vh;">
            <div style="font-size: 6rem; color: var(--primary-color); animation: float 3s ease-in-out infinite; cursor: pointer;" id="loveHeart">
                üíñ
            </div>
            <div style="font-family: 'Dancing Script', cursive; font-size: 1.8rem; color: var(--primary-color); margin-top: 30px; opacity: 0; transition: opacity 1s;" id="loveMessage">
                I LOVE YOU, IMELDA! üíï
            </div>
        </div>
    </div>

    <!-- Halaman 6: Pantun -->
    <div class="page-scroll" id="page6">
        <div class="page-header">
            <h1 class="page-title">Pantun Cinta üíò</h1>
        </div>
        
        <div style="width: 90%; max-width: 500px; margin: 0 auto; padding-bottom: 100px;" id="pantunContainer">
            <!-- Pantun akan dimuat dengan JavaScript -->
        </div>
    </div>

    <!-- Halaman 7: Penutup -->
    <div class="page-scroll" id="page7">
        <div class="page-header">
            <h1 class="page-title">Terima Kasih ü•∞</h1>
        </div>
        
        <div style="background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 30px 25px; margin: 20px auto; max-width: 500px; text-align: center;">
            <p style="font-size: 1.1rem; margin-bottom: 20px; line-height: 1.7;">
                Aku harap kamu suka dengan kejutan kecil ini. Semua ini aku buat dengan penuh cinta dan perasaan untukmu.
            </p>
            
            <p style="font-size: 1.2rem; color: var(--primary-color); font-weight: 600; margin: 25px 0;">
                Kamu adalah orang yang sangat spesial dalam hidupku üíñ
            </p>
            
            <div style="display: flex; justify-content: center; gap: 20px; margin: 30px 0;">
                <div style="font-size: 2.5rem;">üê∞</div>
                <div style="font-size: 2.5rem;">üê±</div>
                <div style="font-size: 2.5rem;">üêª</div>
            </div>
            
            <p style="font-family: 'Dancing Script', cursive; font-size: 1.4rem; margin: 20px 0;">
                Jangan lupa tersenyum hari ini! üòä
            </p>
            
            <a href="https://wa.me/6285954498360?text=Hai%20Imelda%2C%20aku%20sudah%20melihat%20website%20kejutanmu.%20Sangat%20indah%20dan%20penuh%20cinta%20%F0%9F%92%96" 
               style="display: inline-flex; align-items: center; gap: 10px; background: linear-gradient(45deg, #25D366, #128C7E); color: white; text-decoration: none; padding: 15px 30px; border-radius: 50px; font-weight: 600; font-size: 1rem; margin-top: 30px;"
               target="_blank">
                <i class="fab fa-whatsapp"></i> Kirim Pesan
            </a>
        </div>
    </div>

    <!-- Navigasi dots -->
    <div class="nav-dots" id="navDots">
        <!-- Dots akan dibuat dengan JavaScript -->
    </div>

    <script>
        // Data scrapbook - FIXED
        const scrapbookData = [
            {
                title: "Hari Pertama Kita Bertemu",
                content: "Aku masih ingat jelas bagaimana senyumanmu membuat hatiku berdebar-debar. Kamu seperti sinar matahari di pagi hari yang menghangatkan dan menerangi. Sejak momen itu, hidupku tidak pernah sama lagi.",
                decorations: ["üíñ", "‚≠ê", "üå∏"]
            },
            {
                title: "Percakapan Kita",
                content: "Percakapan kita yang sederhana namun penuh makna selalu membuatku tersenyum. Meski hanya membicarakan hal-hal kecil, setiap kata yang keluar dari mulutmu terasa begitu berarti.",
                decorations: ["üí¨", "‚ú®", "üéÄ"]
            },
            {
                title: "Jalan Pertama Kita",
                content: "Aku masih ingat jelas hari pertama kita jalan bersama. Rasa gugup yang bercampur bahagia, tangan yang sedikit berkeringat, dan senyumanmu yang membuat semua rasa gugup itu hilang dalam sekejap.",
                decorations: ["üö∂‚Äç‚ôÄÔ∏è", "‚ù§Ô∏è", "‚òÄÔ∏è"]
            },
            {
                title: "Tertawamu yang Indah",
                content: "Tertawamu adalah musik terindah yang pernah aku dengar. Setiap kali kamu tertawa, dunia seakan berhenti sejenak dan hanya fokus pada kebahagiaanmu.",
                decorations: ["üòä", "üéµ", "üåà"]
            },
            {
                title: "Setiap Detail Tentangmu",
                content: "Kadang diam-diam aku memperhatikanmu. Cara kamu bicara dengan antusias, cara kamu tertawa lepas, bahkan cara kamu mengernyitkan dahi saat sedang serius berpikir.",
                decorations: ["üëÄ", "üé®", "üíï"]
            },
            {
                title: "Bersyukur Memilikimu",
                content: "Aku bersyukur tak terhingga memiliki kamu dalam hidupku. Kamu adalah penyemangat di saat lelah, tempat bercerita di saat sedih, dan cahaya di saat gelap.",
                decorations: ["üôè", "üåü", "üíå"]
            },
            {
                title: "Masa Depan Bersamamu",
                content: "Untuk masa depan, aku ingin terus berjalan bersamamu. Melewati suka dan duka, tertawa dan menangis, semua ingin aku lalui bersamamu. Aku sayang kamu lebih dari kata-kata bisa ungkapkan.",
                decorations: ["üöÄ", "üíë", "üéâ"]
            }
        ];

        const pantunList = [
           "Burung dara terbang ke taman<br>Hinggap sebentar di dahan jati<br>Sejak bertemu wahai idaman<br>Senyummu melekat di dalam hati",
            "Makan nasi pakai bakwan<br>Minumnya es kelapa muda<br>Siang teringat wajahmu tuan<br>Malam pun hadir di dalam dada",
            "Pergi ke pasar membeli sepatu<br>Jangan lupa beli kemeja<br>Hatiku ini hanyalah satu<br>Untuk dirimu seorang saja",
            "Masak air di dalam panci<br>Nunggu mendidih sambil baca buku<br>Tak perlu janji tak perlu saksi<br>Cukup kau ada di sampingku",
            "Jalan-jalan ke Kota Tua<br>Naik sepeda bersama teman<br>Raga terpisah jarak berdua<br>Rindu ini kian tak tertahan",
            "Bunga mawar harum baunya<br>Tumbuh mekar di tepi taman<br>Engkaulah satu untuk selamanya<br>Pendamping setia sepanjang zaman",
            "Langit biru awannya putih<br>Sungguh indah dipandang mata<br>Terima kasih wahai kekasih<br>Telah jadi bagian dari cerita"
        ];

        // State aplikasi
        let currentPage = 1;
        let scrapbookPage = 0;
        let musicPlaying = false;
        let fireworksActive = false;
        let loveClicked = false;
        let fireworksInterval;
        let typewriterIntervals = {}; // Object untuk menyimpan interval setiap halaman

        // Inisialisasi
        function init() {
            createStars();
            createNavigationDots();
            loadScrapbook();
            loadPantun();
            setupEventListeners();
            updatePageIndicator();
            
            // Mulai animasi untuk halaman scrapbook pertama
            setTimeout(() => {
                startTypingAnimation(0);
            }, 500);
        }

        // Buat bintang di background
        function createStars() {
            const starField = document.getElementById('starField');
            starField.innerHTML = '';
            
            for (let i = 0; i < 80; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = `${Math.random() * 3 + 1}px`;
                star.style.height = star.style.width;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.animationDelay = `${Math.random() * 3}s`;
                star.style.opacity = Math.random() * 0.5 + 0.3;
                starField.appendChild(star);
            }
        }

        // Buat navigasi dots
        function createNavigationDots() {
            const navDots = document.getElementById('navDots');
            navDots.innerHTML = '';
            
            for (let i = 1; i <= 7; i++) {
                const dot = document.createElement('div');
                dot.className = `nav-dot ${i === 1 ? 'active' : ''}`;
                dot.dataset.page = i;
                dot.addEventListener('click', () => goToPage(i));
                navDots.appendChild(dot);
            }
        }

        // Pergi ke halaman tertentu
        function goToPage(pageNum) {
            if (pageNum < 1 || pageNum > 7) return;
            
            // Sembunyikan halaman aktif
            document.querySelector('.page-scroll.active').classList.remove('active');
            document.querySelector(`.nav-dot[data-page="${currentPage}"]`).classList.remove('active');
            
            // Tampilkan halaman baru
            document.getElementById(`page${pageNum}`).classList.add('active');
            document.querySelector(`.nav-dot[data-page="${pageNum}"]`).classList.add('active');
            
            // Tampilkan/sembunyikan navigasi scrapbook
            const scrapbookNav = document.getElementById('scrapbookNav');
            if (pageNum === 4) {
                scrapbookNav.style.display = 'flex';
                updateScrapbookNav();
                // Mulai animasi untuk halaman scrapbook yang aktif
                setTimeout(() => {
                    startTypingAnimation(scrapbookPage);
                }, 300);
            } else {
                scrapbookNav.style.display = 'none';
                // Hentikan semua animasi typewriter
                stopAllTypingAnimations();
            }
            
            // Update state
            currentPage = pageNum;
            updatePageIndicator();
            
            // Handle efek khusus per halaman
            handlePageEffects(pageNum);
            
            // Scroll ke atas halaman
            document.getElementById(`page${pageNum}`).scrollTop = 0;
        }

        // Update indikator halaman
        function updatePageIndicator() {
            document.getElementById('pageIndicator').textContent = `Halaman ${currentPage}/7`;
        }

        // Handle efek khusus per halaman
        function handlePageEffects(pageNum) {
            // Hentikan efek dari halaman sebelumnya
            if (pageNum !== 3 && fireworksActive) {
                stopFireworks();
            }
            
            if (pageNum === 5 && !loveClicked) {
                resetLoveAnimation();
            }
        }

        // Scrapbook - FIXED
        function loadScrapbook() {
            const container = document.getElementById('scrapbookContainer');
            container.innerHTML = '';
            
            scrapbookData.forEach((page, index) => {
                const pageElement = document.createElement('div');
                pageElement.className = 'scrapbook-page-single';
                pageElement.id = `scrapbook-page-${index}`;
                pageElement.style.animationDelay = `${index * 0.1}s`;
                
                // Garis kertas
                const paperLines = document.createElement('div');
                paperLines.className = 'paper-lines';
                pageElement.appendChild(paperLines);
                
                // Konten dengan container untuk typewriter
                const content = document.createElement('div');
                content.className = 'scrapbook-content';
                content.innerHTML = `
                    <h3 class="scrapbook-title">${page.title}</h3>
                    <div class="typewriter-container">
                        <span class="typewriter-text" id="typewriter-text-${index}"></span>
                        <span class="typewriter-cursor" id="typewriter-cursor-${index}"></span>
                    </div>
                `;
                pageElement.appendChild(content);
                
                // Dekorasi
                page.decorations.forEach((deco, i) => {
                    const decoration = document.createElement('div');
                    decoration.className = 'scrapbook-decoration';
                    decoration.textContent = deco;
                    decoration.style.left = `${Math.random() * 70 + 15}%`;
                    decoration.style.top = `${Math.random() * 60 + 20}%`;
                    decoration.style.fontSize = `${Math.random() * 0.5 + 1.5}rem`;
                    decoration.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
                    pageElement.appendChild(decoration);
                });
                
                // Nomor halaman
                const pageNum = document.createElement('div');
                pageNum.className = 'page-number';
                pageNum.textContent = `Halaman ${index + 1}`;
                pageElement.appendChild(pageNum);
                
                container.appendChild(pageElement);
            });
            
            updateScrapbookNav();
        }

        function updateScrapbookNav() {
            document.getElementById('currentScrapbookPage').textContent = scrapbookPage + 1;
            document.getElementById('totalScrapbookPages').textContent = scrapbookData.length;
            
            document.getElementById('prevScrapbookPage').disabled = scrapbookPage === 0;
            document.getElementById('nextScrapbookPage').disabled = scrapbookPage === scrapbookData.length - 1;
            
            // Scroll ke halaman aktif
            const activePage = document.getElementById(`scrapbook-page-${scrapbookPage}`);
            if (activePage) {
                activePage.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Typewriter animation - FIXED
        function startTypingAnimation(pageIndex) {
            // Hentikan animasi sebelumnya untuk halaman ini
            stopTypingAnimation(pageIndex);
            
            const textElement = document.getElementById(`typewriter-text-${pageIndex}`);
            const cursorElement = document.getElementById(`typewriter-cursor-${pageIndex}`);
            
            if (!textElement || !cursorElement) {
                console.log(`Element not found for page ${pageIndex}`);
                return;
            }
            
            const text = scrapbookData[pageIndex].content;
            textElement.textContent = '';
            cursorElement.style.display = 'inline-block';
            
            let i = 0;
            
            // Simpan interval di object untuk bisa dihentikan nanti
            typewriterIntervals[pageIndex] = setInterval(() => {
                if (i < text.length) {
                    textElement.textContent += text.charAt(i);
                    i++;
                } else {
                    // Selesai mengetik, sembunyikan kursor
                    clearInterval(typewriterIntervals[pageIndex]);
                    delete typewriterIntervals[pageIndex];
                    cursorElement.style.display = 'none';
                }
            }, 30); // Kecepatan mengetik (ms per karakter)
        }

        function stopTypingAnimation(pageIndex) {
            if (typewriterIntervals[pageIndex]) {
                clearInterval(typewriterIntervals[pageIndex]);
                delete typewriterIntervals[pageIndex];
            }
            
            const cursorElement = document.getElementById(`typewriter-cursor-${pageIndex}`);
            if (cursorElement) {
                cursorElement.style.display = 'none';
            }
        }

        function stopAllTypingAnimations() {
            // Hentikan semua interval typewriter
            Object.keys(typewriterIntervals).forEach(pageIndex => {
                clearInterval(typewriterIntervals[pageIndex]);
                const cursorElement = document.getElementById(`typewriter-cursor-${pageIndex}`);
                if (cursorElement) {
                    cursorElement.style.display = 'none';
                }
            });
            typewriterIntervals = {};
        }

        // Pantun
        function loadPantun() {
            const container = document.getElementById('pantunContainer');
            container.innerHTML = '';
            
            pantunList.forEach((pantun, index) => {
                const card = document.createElement('div');
                card.style.background = 'rgba(255, 255, 255, 0.95)';
                card.style.borderRadius = '15px';
                card.style.padding = '20px';
                card.style.marginBottom = '20px';
                card.style.boxShadow = '0 8px 20px rgba(0,0,0,0.1)';
                card.style.borderLeft = '8px solid var(--primary-color)';
                card.style.animation = `fadeInUp 0.5s ease ${index * 0.1}s both`;
                card.innerHTML = `<div style="font-size: 1rem; line-height: 1.7; color: #5a3d2b; text-align: center;">${pantun}</div>`;
                container.appendChild(card);
            });
        }

        // Animasi love
        function resetLoveAnimation() {
            loveClicked = false;
            document.getElementById('loveMessage').style.opacity = '0';
        }

        function createLoveAnimation() {
            if (loveClicked) return;
            loveClicked = true;
            
            const heart = document.getElementById('loveHeart');
            const message = document.getElementById('loveMessage');
            
            // Animasi hati
            heart.style.animation = 'none';
            setTimeout(() => {
                heart.style.animation = 'float 0.5s ease';
            }, 10);
            
            // Tampilkan pesan
            setTimeout(() => {
                message.style.opacity = '1';
            }, 500);
        }

        // Kembang api sederhana
        function createFirework(x, y) {
            const container = document.getElementById('fireworksContainer');
            const colors = ['#ff4081', '#ff79b0', '#00e5ff', '#69f0ae', '#ffcc00'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            const firework = document.createElement('div');
            firework.style.position = 'absolute';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            firework.style.width = '4px';
            firework.style.height = '4px';
            firework.style.borderRadius = '50%';
            firework.style.backgroundColor = color;
            firework.style.boxShadow = `0 0 5px ${color}`;
            container.appendChild(firework);
            
            // Animasi
            const anim = firework.animate([
                { transform: 'scale(1)', opacity: 1 },
                { transform: 'scale(0)', opacity: 0 }
            ], {
                duration: 1000,
                easing: 'ease-out'
            });
            
            anim.onfinish = () => firework.remove();
        }

        function startFireworks() {
            fireworksActive = true;
            const container = document.getElementById('fireworksContainer');
            container.innerHTML = '';
            
            fireworksInterval = setInterval(() => {
                if (!fireworksActive) return;
                
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                createFirework(x, y);
                
                // Buat beberapa percikan
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        createFirework(x + Math.random() * 100 - 50, y + Math.random() * 100 - 50);
                    }, i * 100);
                }
            }, 300);
        }

        function stopFireworks() {
            fireworksActive = false;
            if (fireworksInterval) {
                clearInterval(fireworksInterval);
            }
            document.getElementById('fireworksContainer').innerHTML = '';
        }

        // Event listeners
        function setupEventListeners() {
            // Musik
            const musicControl = document.getElementById('musicControl');
            const music = document.getElementById('bgMusic');
            
            musicControl.addEventListener('click', () => {
                if (musicPlaying) {
                    music.pause();
                    musicControl.innerHTML = '<i class="fas fa-play"></i>';
                } else {
                    music.play().then(() => {
                        musicControl.innerHTML = '<i class="fas fa-pause"></i>';
                    }).catch(e => {
                        console.log('Audio error:', e);
                        musicControl.innerHTML = '<i class="fas fa-play"></i>';
                    });
                }
                musicPlaying = !musicPlaying;
            });
            
            // Kembang api
            document.getElementById('startFireworks').addEventListener('click', () => {
                if (!fireworksActive) {
                    startFireworks();
                    document.getElementById('startFireworks').innerHTML = '<i class="fas fa-stop"></i> Hentikan Kembang Api';
                } else {
                    stopFireworks();
                    document.getElementById('startFireworks').innerHTML = '<i class="fas fa-play"></i> Tampilkan Kembang Api';
                }
            });
            
            // Scrapbook navigation - FIXED
            document.getElementById('prevScrapbookPage').addEventListener('click', () => {
                if (scrapbookPage > 0) {
                    // Hentikan animasi halaman saat ini
                    stopTypingAnimation(scrapbookPage);
                    
                    scrapbookPage--;
                    updateScrapbookNav();
                    
                    // Mulai animasi untuk halaman baru
                    setTimeout(() => {
                        startTypingAnimation(scrapbookPage);
                    }, 300);
                }
            });
            
            document.getElementById('nextScrapbookPage').addEventListener('click', () => {
                if (scrapbookPage < scrapbookData.length - 1) {
                    // Hentikan animasi halaman saat ini
                    stopTypingAnimation(scrapbookPage);
                    
                    scrapbookPage++;
                    updateScrapbookNav();
                    
                    // Mulai animasi untuk halaman baru
                    setTimeout(() => {
                        startTypingAnimation(scrapbookPage);
                    }, 300);
                }
            });
            
            // Love animation
            document.getElementById('loveHeart').addEventListener('click', createLoveAnimation);
            
            // Swipe navigation untuk mobile
            let touchStartX = 0;
            let touchStartY = 0;
            
            document.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].clientX;
                touchStartY = e.changedTouches[0].clientY;
            });
            
            document.addEventListener('touchend', (e) => {
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                
                const diffX = touchStartX - touchEndX;
                const diffY = touchStartY - touchEndY;
                
                // Hanya proses swipe horizontal yang signifikan
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                    if (diffX > 0 && currentPage < 7) {
                        goToPage(currentPage + 1);
                    } else if (diffX < 0 && currentPage > 1) {
                        goToPage(currentPage - 1);
                    }
                }
            });
            
            // Klik untuk navigasi (area kiri/kanan layar)
            document.addEventListener('click', (e) => {
                // Skip jika klik pada elemen interaktif
                if (e.target.closest('button') || 
                    e.target.closest('a') || 
                    e.target.closest('.nav-dot') ||
                    e.target.closest('.mobile-controls') ||
                    e.target.closest('.scrapbook-nav')) {
                    return;
                }
                
                const clickX = e.clientX;
                const screenWidth = window.innerWidth;
                
                // Klik di bagian kanan 25% layar untuk next
                if (clickX > screenWidth * 0.75 && currentPage < 7) {
                    goToPage(currentPage + 1);
                }
                // Klik di bagian kiri 25% layar untuk previous
                else if (clickX < screenWidth * 0.25 && currentPage > 1) {
                    goToPage(currentPage - 1);
                }
            });
            
            // Keyboard navigation untuk testing
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft' && currentPage > 1) {
                    goToPage(currentPage - 1);
                } else if (e.key === 'ArrowRight' && currentPage < 7) {
                    goToPage(currentPage + 1);
                }
            });
            
            // Preload audio
            music.volume = 0.5;
            music.load();
        }

        // Inisialisasi saat halaman dimuat
        window.addEventListener('DOMContentLoaded', init);
        
        // Pastikan scrapbook siap saat halaman 4 aktif
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && currentPage === 4) {
                setTimeout(() => {
                    startTypingAnimation(scrapbookPage);
                }, 500);
            }
        });
    </script>
</body>
</html>